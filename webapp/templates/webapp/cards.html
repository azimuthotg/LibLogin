{% extends 'webapp/base.html' %}

{% block title %}Cards - LibLogin Management{% endblock %}
{% block page_title %}Card Content Management{% endblock %}

{% block extra_css %}
<style>
    .stats-strip { display:flex; gap:12px; margin-bottom:24px; flex-wrap:wrap; }
    .stat-pill {
        display:flex; align-items:center; gap:8px;
        background:#fff; border-radius:50px; padding:8px 18px;
        font-family:'Sarabun',sans-serif; font-size:.82rem; color:#64748b;
        box-shadow:0 1px 4px rgba(0,0,0,.07); border:1px solid #e9eef4;
    }
    .stat-pill .pill-val { font-family:'Kanit',sans-serif; font-weight:700; font-size:1rem; color:#1e293b; }
    .stat-pill .pill-icon { font-size:.9rem; }
    .stat-pill.total .pill-icon   { color:#3498db; }
    .stat-pill.active .pill-icon  { color:#22c55e; }
    .stat-pill.inactive .pill-icon{ color:#94a3b8; }

    .page-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; gap:12px; flex-wrap:wrap; }
    .page-header-left h4 { font-family:'Kanit',sans-serif; font-weight:700; font-size:1.2rem; color:#1e293b; margin:0 0 4px; }
    .page-header-left p  { font-family:'Sarabun',sans-serif; font-size:.82rem; color:#64748b; margin:0; }

    .info-banner {
        background:linear-gradient(135deg,rgba(52,152,219,.08),rgba(44,62,80,.05));
        border:1px solid rgba(52,152,219,.2); border-left:4px solid #3498db;
        border-radius:10px; padding:12px 16px;
        display:flex; align-items:flex-start; gap:10px;
        font-family:'Sarabun',sans-serif; font-size:.85rem; color:#334155; margin-bottom:24px;
    }
    .info-banner i { color:#3498db; margin-top:1px; }

    .table-card {
        background:#fff; border-radius:14px; border:1.5px solid #e9eef4;
        overflow:hidden; box-shadow:0 1px 6px rgba(0,0,0,.05);
    }
    .table-card table { width:100%; border-collapse:collapse; }
    .table-card thead th {
        background:#f8fafc; font-family:'Kanit',sans-serif; font-weight:600;
        font-size:.78rem; color:#64748b; letter-spacing:.04em; text-transform:uppercase;
        padding:13px 16px; border-bottom:1.5px solid #e9eef4; white-space:nowrap;
    }
    .table-card tbody tr { transition:background .15s; }
    .table-card tbody tr:hover { background:#f8fafc; }
    .table-card tbody td {
        padding:13px 16px; border-bottom:1px solid #f1f5f9;
        font-family:'Sarabun',sans-serif; font-size:.875rem; color:#334155;
        vertical-align:middle;
    }
    .table-card tbody tr:last-child td { border-bottom:none; }

    .item-icon-cell { width:52px; height:52px; display:flex; align-items:center; justify-content:center; }
    .item-icon-cell img { width:44px; height:44px; object-fit:contain; border-radius:8px; }
    .item-icon-cell .icon-emoji { font-size:1.8rem; line-height:1; }
    .item-title { font-family:'Kanit',sans-serif; font-weight:600; font-size:.9rem; color:#1e293b; }
    .item-desc  { font-family:'Sarabun',sans-serif; font-size:.8rem; color:#94a3b8; margin-top:2px; }

    .hotspot-badge { display:inline-flex; align-items:center; gap:4px; background:#f0f4f8; color:#475569; border:1px solid #e2e8f0; border-radius:6px; padding:3px 9px; font-family:'Kanit',sans-serif; font-size:.72rem; font-weight:500; }
    .order-badge { display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; border-radius:8px; background:rgba(52,152,219,.1); color:#2980b9; font-family:'Kanit',sans-serif; font-weight:700; font-size:.82rem; }
    .status-badge { display:inline-flex; align-items:center; gap:5px; font-family:'Kanit',sans-serif; font-size:.72rem; font-weight:600; padding:3px 10px; border-radius:50px; }
    .status-badge.active   { background:rgba(34,197,94,.12); color:#16a34a; border:1px solid rgba(34,197,94,.25); }
    .status-badge.inactive { background:rgba(148,163,184,.12); color:#64748b; border:1px solid rgba(148,163,184,.25); }
    .status-dot { width:6px; height:6px; border-radius:50%; background:currentColor; }

    .btn-row { display:flex; gap:6px; }
    .btn-icon { display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px; border-radius:8px; border:none; cursor:pointer; font-size:.85rem; transition:all .15s; }
    .btn-icon-edit   { background:rgba(44,62,80,.08); color:#2c3e50; }
    .btn-icon-edit:hover  { background:rgba(44,62,80,.18); }
    .btn-icon-delete { background:rgba(239,68,68,.08); color:#dc2626; }
    .btn-icon-delete:hover { background:rgba(239,68,68,.18); }

    .empty-row td { text-align:center; padding:56px 24px !important; }
    .empty-icon-lg { font-size:2.5rem; color:#cbd5e1; margin-bottom:12px; }
    .empty-row h6 { font-family:'Kanit',sans-serif; color:#94a3b8; margin-bottom:6px; }
    .empty-row p  { font-family:'Sarabun',sans-serif; font-size:.82rem; color:#b8c4cf; margin:0; }

    .modal-header-dark { background:linear-gradient(135deg,#1a2535 0%,#2c3e50 100%); padding:18px 20px; border-bottom:none; }
    .modal-header-dark .modal-title { font-family:'Kanit',sans-serif; font-weight:600; font-size:.95rem; color:#fff; display:flex; align-items:center; gap:8px; }
    .modal-header-dark .btn-close { filter:invert(1) brightness(2); }
    .modal-header-danger { background:linear-gradient(135deg,#991b1b,#dc2626); padding:18px 20px; border-bottom:none; }
    .modal-header-danger .modal-title { font-family:'Kanit',sans-serif; font-weight:600; font-size:.95rem; color:#fff; display:flex; align-items:center; gap:8px; }
    .modal-header-danger .btn-close { filter:invert(1) brightness(2); }

    .modal-body  { padding:20px; }
    .modal-footer { padding:14px 20px; border-top:1px solid #f1f5f9; }

    .form-label-s { font-family:'Kanit',sans-serif; font-weight:500; font-size:.82rem; color:#374151; display:block; margin-bottom:6px; }
    .form-ctrl-s { width:100%; padding:10px 13px; border:1.5px solid #e2e8f0; border-radius:9px; font-family:'Sarabun',sans-serif; font-size:.875rem; color:#1e293b; background:#fff; transition:border-color .2s,box-shadow .2s; -webkit-appearance:none; appearance:none; }
    .form-ctrl-s:focus { outline:none; border-color:#3498db; box-shadow:0 0 0 3px rgba(52,152,219,.12); }
    .form-select-s { width:100%; padding:10px 13px; border:1.5px solid #e2e8f0; border-radius:9px; font-family:'Sarabun',sans-serif; font-size:.875rem; color:#1e293b; background:#fff; transition:border-color .2s,box-shadow .2s; }
    .form-select-s:focus { outline:none; border-color:#3498db; box-shadow:0 0 0 3px rgba(52,152,219,.12); }
    .helper-text { font-family:'Sarabun',sans-serif; font-size:.77rem; color:#94a3b8; margin-top:5px; }

    .icon-option-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .icon-option-box { border:1.5px solid #e2e8f0; border-radius:10px; padding:12px; background:#f8fafc; }
    .icon-option-label { font-family:'Kanit',sans-serif; font-size:.72rem; font-weight:600; color:#64748b; letter-spacing:.04em; text-transform:uppercase; display:block; margin-bottom:8px; }
    .form-row-2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .check-item { display:flex; align-items:center; gap:8px; padding:10px 12px; background:#f8fafc; border:1.5px solid #e2e8f0; border-radius:9px; cursor:pointer; }
    .check-item label { font-family:'Sarabun',sans-serif; font-size:.875rem; color:#374151; cursor:pointer; margin:0; }
    .check-item input[type="checkbox"] { accent-color:#3498db; width:15px; height:15px; }
    .delete-warn-box { background:#fef2f2; border:1px solid rgba(239,68,68,.25); border-radius:10px; padding:14px 16px; font-family:'Sarabun',sans-serif; font-size:.85rem; color:#991b1b; display:flex; align-items:flex-start; gap:10px; }
    .delete-warn-box i { flex-shrink:0; }

    .btn-modal-primary { background:linear-gradient(135deg,#2c3e50,#3498db); color:#fff; border:none; border-radius:8px; font-family:'Kanit',sans-serif; font-weight:600; font-size:.85rem; padding:9px 20px; cursor:pointer; transition:all .2s; }
    .btn-modal-primary:hover { transform:translateY(-1px); box-shadow:0 4px 14px rgba(52,152,219,.35); }
    .btn-modal-danger  { background:#dc2626; color:#fff; border:none; border-radius:8px; font-family:'Kanit',sans-serif; font-weight:600; font-size:.85rem; padding:9px 20px; cursor:pointer; }
    .btn-modal-danger:hover { background:#b91c1c; }
    .btn-modal-cancel  { background:#f1f5f9; color:#64748b; border:none; border-radius:8px; font-family:'Kanit',sans-serif; font-weight:500; font-size:.85rem; padding:9px 16px; cursor:pointer; }
    .btn-modal-cancel:hover { background:#e2e8f0; }
    .mb-f { margin-bottom:16px; }
    .section-divider { height:1px; background:#f1f5f9; margin:16px 0; }
</style>
{% endblock %}

{% block content %}

<div class="stats-strip">
    <div class="stat-pill total">
        <i class="bi bi-grid-3x3 pill-icon"></i>
        <span class="pill-val">{{ cards|length }}</span>
        <span>Card ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
    </div>
    <div class="stat-pill active">
        <i class="bi bi-check-circle-fill pill-icon"></i>
        <span class="pill-val">{% for c in cards %}{% if c.is_active %}1{% endif %}{% endfor %}</span>
        <span>Active</span>
    </div>
    <div class="stat-pill inactive">
        <i class="bi bi-pause-circle pill-icon"></i>
        <span class="pill-val">{% for c in cards %}{% if not c.is_active %}1{% endif %}{% endfor %}</span>
        <span>Inactive</span>
    </div>
</div>

<div class="page-header">
    <div class="page-header-left">
        <h4><i class="bi bi-grid-3x3 me-2" style="color:#3498db;"></i>Card Gallery Content</h4>
        <p>Card ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Grid ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Login ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° Order ‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å</p>
    </div>
    <button class="btn-modal-primary" data-bs-toggle="modal" data-bs-target="#createCardModal">
        <i class="bi bi-plus-lg me-1"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏° Card ‡πÉ‡∏´‡∏°‡πà
    </button>
</div>

<div class="info-banner">
    <i class="bi bi-info-circle-fill"></i>
    <div>Card ‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Gallery Grid ‚Äî ‡πÉ‡∏ä‡πâ Icon Emoji ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡πá‡πÑ‡∏î‡πâ</div>
</div>

<div class="table-card">
    <div style="overflow-x:auto;">
        <table>
            <thead>
                <tr>
                    <th>Icon</th>
                    <th>Title / Description</th>
                    <th>Hotspot</th>
                    <th>Order</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for card in cards %}
                <tr>
                    <td>
                        <div class="item-icon-cell">
                            {% if card.icon_image %}
                            <img src="{{ card.icon_image.url }}" alt="icon">
                            {% else %}
                            <span class="icon-emoji">{{ card.icon }}</span>
                            {% endif %}
                        </div>
                    </td>
                    <td>
                        <div class="item-title">{{ card.title }}</div>
                        <div class="item-desc">{{ card.description|truncatewords:12 }}</div>
                    </td>
                    <td>
                        <span class="hotspot-badge">
                            <i class="bi bi-router"></i>
                            {{ card.hotspot_name|default:"‡∏ó‡∏∏‡∏Å Hotspot" }}
                        </span>
                    </td>
                    <td><span class="order-badge">{{ card.order }}</span></td>
                    <td>
                        <span class="status-badge {% if card.is_active %}active{% else %}inactive{% endif %}">
                            <span class="status-dot"></span>
                            {% if card.is_active %}Active{% else %}Inactive{% endif %}
                        </span>
                    </td>
                    <td>
                        <div class="btn-row">
                            <button class="btn-icon btn-icon-edit"
                                    onclick="editCard({{ card.id }}, '{{ card.icon|escapejs }}', '{{ card.title|escapejs }}', '{{ card.description|escapejs }}', '{{ card.hotspot_name|default:''|escapejs }}', {{ card.order }}, {{ card.is_active|lower }})"
                                    title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn-icon btn-icon-delete"
                                    onclick="deleteCard({{ card.id }}, '{{ card.title|escapejs }}')"
                                    title="‡∏•‡∏ö">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr class="empty-row">
                    <td colspan="6">
                        <div class="empty-icon-lg"><i class="bi bi-grid-3x3"></i></div>
                        <h6>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Card</h6>
                        <p>‡πÄ‡∏û‡∏¥‡πà‡∏° Card ‡πÅ‡∏£‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Card Gallery ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Login</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ Create Card Modal ‚îÄ‚îÄ‚îÄ -->
<div class="modal fade" id="createCardModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius:14px; overflow:hidden; border:none;">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="action" value="create">

                <div class="modal-header-dark">
                    <h5 class="modal-title"><i class="bi bi-plus-circle"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏° Card ‡πÉ‡∏´‡∏°‡πà</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-f">
                        <label class="form-label-s">Icon <span style="color:#e74c3c">*</span></label>
                        <div class="icon-option-grid">
                            <div class="icon-option-box">
                                <span class="icon-option-label">Option 1: Emoji</span>
                                <input type="text" class="form-ctrl-s" name="icon" placeholder="üìö">
                            </div>
                            <div class="icon-option-box">
                                <span class="icon-option-label">Option 2: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ</span>
                                <input type="file" class="form-ctrl-s" name="icon_image" accept="image/*" style="padding:7px 10px;">
                            </div>
                        </div>
                        <p class="helper-text">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Emoji ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 100√ó100px)</p>
                    </div>

                    <div class="mb-f">
                        <label class="form-label-s">Title <span style="color:#e74c3c">*</span></label>
                        <input type="text" class="form-ctrl-s" name="title" required placeholder="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•">
                    </div>

                    <div class="mb-f">
                        <label class="form-label-s">Description <span style="color:#e74c3c">*</span></label>
                        <textarea class="form-ctrl-s" name="description" rows="3" required placeholder="‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢..."></textarea>
                    </div>

                    <div class="section-divider"></div>

                    <div class="form-row-2">
                        <div>
                            <label class="form-label-s">Hotspot (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                            <select class="form-select-s hotspot-dropdown" name="hotspot_name" id="addHotspotName" data-include-blank="true">
                                <option value="">Loading hotspots...</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label-s">Display Order</label>
                            <input type="number" class="form-ctrl-s" name="order" value="0" min="0">
                            <p class="helper-text">‡πÄ‡∏•‡∏Ç‡∏ô‡πâ‡∏≠‡∏¢‡πÅ‡∏™‡∏î‡∏á‡∏Å‡πà‡∏≠‡∏ô</p>
                        </div>
                    </div>

                    <div style="margin-top:14px;" class="check-item">
                        <input type="checkbox" name="is_active" id="createIsActive" checked>
                        <label for="createIsActive">Active (‡πÅ‡∏™‡∏î‡∏á Card ‡∏ô‡∏µ‡πâ)</label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn-modal-primary"><i class="bi bi-plus-lg me-1"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á Card</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ Edit Card Modal ‚îÄ‚îÄ‚îÄ -->
<div class="modal fade" id="editCardModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius:14px; overflow:hidden; border:none;">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="action" value="update">
                <input type="hidden" name="card_id" id="editCardId">

                <div class="modal-header-dark">
                    <h5 class="modal-title"><i class="bi bi-pencil"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Card</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-f">
                        <label class="form-label-s">Icon</label>
                        <div class="icon-option-grid">
                            <div class="icon-option-box">
                                <span class="icon-option-label">Option 1: Emoji</span>
                                <input type="text" class="form-ctrl-s" name="icon" id="editIcon" placeholder="üìö">
                            </div>
                            <div class="icon-option-box">
                                <span class="icon-option-label">Option 2: ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà</span>
                                <input type="file" class="form-ctrl-s" name="icon_image" accept="image/*" style="padding:7px 10px;">
                            </div>
                        </div>
                        <p class="helper-text">‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏î‡∏¥‡∏°</p>
                    </div>

                    <div class="mb-f">
                        <label class="form-label-s">Title <span style="color:#e74c3c">*</span></label>
                        <input type="text" class="form-ctrl-s" name="title" id="editTitle" required>
                    </div>

                    <div class="mb-f">
                        <label class="form-label-s">Description <span style="color:#e74c3c">*</span></label>
                        <textarea class="form-ctrl-s" name="description" id="editDescription" rows="3" required></textarea>
                    </div>

                    <div class="section-divider"></div>

                    <div class="form-row-2">
                        <div>
                            <label class="form-label-s">Hotspot (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                            <select class="form-select-s hotspot-dropdown" name="hotspot_name" id="editRouterId" data-include-blank="true">
                                <option value="">Loading hotspots...</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label-s">Display Order</label>
                            <input type="number" class="form-ctrl-s" name="order" id="editOrder" min="0">
                        </div>
                    </div>

                    <div style="margin-top:14px;" class="check-item">
                        <input type="checkbox" name="is_active" id="editIsActive">
                        <label for="editIsActive">Active (‡πÅ‡∏™‡∏î‡∏á Card ‡∏ô‡∏µ‡πâ)</label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn-modal-primary"><i class="bi bi-check-lg me-1"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- ‚îÄ‚îÄ‚îÄ Delete Card Modal ‚îÄ‚îÄ‚îÄ -->
<div class="modal fade" id="deleteCardModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius:14px; overflow:hidden; border:none;">
            <form method="POST">
                {% csrf_token %}
                <input type="hidden" name="action" value="delete">
                <input type="hidden" name="card_id" id="deleteCardId">

                <div class="modal-header-danger">
                    <h5 class="modal-title"><i class="bi bi-trash"></i> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <p style="font-family:'Sarabun',sans-serif; font-size:.9rem; color:#334155; margin-bottom:14px;">
                        ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö Card <strong id="deleteCardTitle"></strong> ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
                    </p>
                    <div class="delete-warn-box">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        <span>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ</span>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn-modal-danger"><i class="bi bi-trash me-1"></i> ‡∏•‡∏ö Card</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function editCard(id, icon, title, description, routerId, order, isActive) {
    try {
        document.getElementById('editCardId').value = id;
        document.getElementById('editIcon').value = icon;
        document.getElementById('editTitle').value = title;
        document.getElementById('editDescription').value = description;
        document.getElementById('editOrder').value = order;
        document.getElementById('editIsActive').checked = isActive;
        loadHotspotChoices('editRouterId', routerId, true);
        new bootstrap.Modal(document.getElementById('editCardModal')).show();
    } catch (error) {
        console.error('[Edit Card Error]', error);
        showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ', 'error');
    }
}

function deleteCard(id, title) {
    try {
        document.getElementById('deleteCardId').value = id;
        document.getElementById('deleteCardTitle').textContent = title;
        new bootstrap.Modal(document.getElementById('deleteCardModal')).show();
    } catch (error) {
        console.error('[Delete Card Error]', error);
        showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏ö‡πÑ‡∏î‡πâ', 'error');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('form').forEach(function(form) {
        const action = form.querySelector('input[name="action"]');
        if (action) {
            form.addEventListener('submit', function() {
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...';
                    setTimeout(() => submitBtn.disabled = false, 3000);
                }
            });
        }
    });

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === '1') {
        showToast('‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        window.history.replaceState({}, document.title, window.location.pathname);
    }
});
</script>

{% load static %}
<script src="{% static 'webapp/js/hotspot-dropdown.js' %}"></script>
{% endblock %}
